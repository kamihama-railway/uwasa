# Bug Traversal & Fixes

## 1. Standard VM String Concatenation Regression (Fixed)

### Description
In the standard Stack VM (`vm.go`), fused instructions like `OpAddGlobal` and `OpAddGlobalGlobal` (generated by the peephole optimizer) were incorrectly assuming numeric types. When these instructions encountered strings, they would fallback to `valToFloat64`, which fails for strings, resulting in a result of `0.0`.

### Impact
- Logic error: Expressions like `s1 + " " + s2` would return `0` instead of a concatenated string when executed via the VM path.
- Misleading performance: The bug caused the VM to skip string allocation, appearing faster and with fewer allocations than it actually should have been.

### Fix
Updated `vm.go` dispatch loops to explicitly handle `ValString` in fused addition opcodes:
```go
if lv.Type == ValInt && rv.Type == ValInt {
    stack[sp] = Value{Type: ValInt, Num: lv.Num + rv.Num}
} else if lv.Type == ValString && rv.Type == ValString {
    stack[sp] = Value{Type: ValString, Str: lv.Str + rv.Str}
} else { ... }
```

### Verification
Added `TestVM_FusedStringConcat` to `vm_test.go` to ensure this behavior is maintained.
